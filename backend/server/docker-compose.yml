version: '4.0'

services:
  web:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "8000:8000"
    volumes:
      - .:/code

    restart: always  
    depends_on:
      - db
      - minio
  
  db: 
    image: postgres:latest
    env_file:
      - .env/local/dev.env
  
  minio:
    image: minio/minio
    ports:
      -9000:9000
      -9090:9090
    volumes:
      - 'minio_data:/data'
    
    env_file:
      - .envs/local/dev.env

    command: server /data --console-address ":9090"

volumes:
  minio_data:
    driver: local        